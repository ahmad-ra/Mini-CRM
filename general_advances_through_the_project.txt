_I used circle CI, as it was advised for a small start-up of 1~3 developers.

_I saw a tut for someone doing tests on a python app and integrating to circle_ci config, will do it on Laravel

_Setting env vars in circle_ci project settings to include docker_hub username/password

_(from docs)
If you are using Workflows, jobs must have unique names within the .circleci/config.yml file.If you are not using workflows, the jobs map must contain a job named build. This build job is the default entry-point for a run that is triggered by a push to your VCS provider.

_Docker build -t repo 
-t: tag the resulting image to refer to the repo

_there is a dot in the end of docker build command

dockerhub uname: ahmrash	


_nothing worked for docker with circle ci for laravel, will try running laravel on docker first without ci.

_The {{username}} should be the username of the dockerhub account, not github. SSHIT SHITTTT

_The image tag should be EXACTLY {{userneme}}/{{image name}}:{{version}}
Lw m3mltsh version fa lw7do 7ydeeha tag latest

_docker build -t $DockerHubUsername /mini-crm: .
echo $DockerHubPass | docker login -u $DockerHubUsername --password-stdin
docker push $DockerHubUsername/mini-crm:


_docker run --rm -v $(pwd):/app composer install
da 3shan mynzlsh composer globally, m3 en el CI kda kda ephermal bs eshta ana bgarrab
Kda nazzel el composer fe container 

_Eldonia meshyet fl Docker. Will try with Circle CI now

_free plan of circle ci doesn't include docker layer caching. Bo5ala

_balash php latest fl docker image 75lleeha 7.2 mthln 3shan el requirements fe composer.json 3ayza php ^7

_ I also have to downgrade mysql image to match the required in this project. Will try 5.7.33-ram

_docker containers initiated by docker run exit after the command, so any later commands (docker exec) referencing to that container will fail as the container is not running!. 
A work around was to restart the container after first initiation (docker restart cont_name) then in the same command do && your needed script.

_exit code is 137, which may be a killing by the host (circle ci) due to being out_of_memory in the free plan. Will make sure by seeing (docker inspect container_name)


_running everything in one job is doable but not a good practice, you have to slice tasks in multiple jobs. BUT each job is ephermal, and you must have all data and files from the 1st job accessible to the 2nd job, and the 1st job will delete all its data after finishing. The solution is using workspaces in circle_ci. Persisting workspace in the first job and attaching to ws in the latter ones.



_php:7.2fpm uses mariadb, so cant install mysql-client. So either use (default-mysql-client) or (mariadb-client)



_I guess I need docker compose to start the database server 

-----------------
Heroku: 

Will integrate Heroku with circle ci, to deploy automatically from the workflow in circle ci
Will have to add environment variables:
HEROKU_LOGIN: ahmad.m.rashed@outlook.com
HEROKU_API_KEY: 
HEROKU_APP: first-try-123

key=$(cat ./artifacts/key)
heroku config:set APP_KEY=$(echo $key | cut -d "[" -f2 | cut -d "]" -f1)
_b3d ma zbbatt mwdoo3 el key bt3 el key generate enno ya5odha mn el artifacts (3shan el php not found fl job bt3 heroku). Ektashaft enny 7atet el Procfile fi config, fa 7tteto fl global

_Laravel worked on Heroku, But not Mysql!
Note from a blog: The usual configuration done using .env file in Laravel is not going work on deployed app because that file is not pushed to Heorku when app is deployed. 
!!!!!!!!!!!!!

_On Heroku project, in resources tab, you should add the Mysql as an addon to the project, name is ClearDBMySQL, bs 8alebn befloos, aw 7atta lw bbalash hwa m7tag credit card, w ana mdmansh en el website mys7bsh floos mn el hosting lamma y7sl clicks 3l site (3han el dynos hours)


_ wb3deen 7t8ayyar el database/config.php t5lleeha tconenct 3la Heroku host
#######for Heroku
// $url = parse_url(getenv("CLEARDB_DATABASE_URL"));
// $host = $url["host"] ?? null;
// $username = $url["user"] ?? null;
// $password = $url["pass"] ?? null;
// $database = substr($url["path"], 1);
####

        // 'mysql' => [
        //     'driver' => 'mysql',
        //     'host' => $host,
        //     'port' => env('DB_PORT', '3306'),
        //     'database' => $database,
        //     'username' => $username,
        //     'password' => $password,
        //     'unix_socket' => env('DB_SOCKET', ''),
        //     'charset' => 'utf8mb4',
        //     'collation' => 'utf8mb4_unicode_ci',
        //     'prefix' => '',
        //     'strict' => true,
        //     'engine' => null,
        // ],

_bs mzbatetsh, fa8yyart 3la db4free.net, w zbatt el database/config.php 3leeha

_Mzabatetsh bardo, error 500 internal server error
_ 5lleeto y3ml migrate mn Heroku (Heroku run php artisan migrate), ra7 s2alny (sure[y/n]?) da 3shan Laravel mane3 elmigrate fl production, w hwa yo3tbr fl production, W da mn gwa job fa m2drsh 23ml input.

_3mlt â€“no-tty fl command, fa 3ml command cancelled lwa7do

_3mlt (heroku run php artisan migrate --force -a first-try-123), fa 2lly  
                                                                               
  SQLSTATE[42000]: Syntax error or access violation: 1231 Variable 'sql_mode'  
   can't be set to the value of 'NO_AUTO_CREATE_USER' (SQL: select * from inf  
  ormation_schema.tables where table_schema = db123dbplease and table_name =   
  migrations)                                                                  
                                                                               

In MySqlConnector.php line 150:
                                                                               
  SQLSTATE[42000]: Syntax error or access violation: 1231 Variable 'sql_mode'  
   can't be set to the value of 'NO_AUTO_CREATE_USER'                          
                                                          

_ fa 7deef el modes fe database/config.php fe mysql

            'modes'  => [
                'ONLY_FULL_GROUP_BY',
                'STRICT_TRANS_TABLES',
                'NO_ZERO_IN_DATE',
                'NO_ZERO_DATE',
                'ERROR_FOR_DIVISION_BY_ZERO',
                'NO_ENGINE_SUBSTITUTION',
            ]

Da bs 3shan Heroku, ennama el migrate elly fl build 3shan testing sh8al 3ady

_eshta8al, bs m3rfsh y3ml login, fa 73ml migrate seed
            heroku run php artisan migrate --force --seed -a first-try-123 




